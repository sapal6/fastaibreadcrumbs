<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Functions for fastaibreadcrumbs.">

<title>fastaibreadcrumbs - fastai-breadcrumbs.core</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="fastaibreadcrumbs - fastai-breadcrumbs.core">
<meta property="og:description" content="Functions for fastaibreadcrumbs.">
<meta property="og:site-name" content="fastaibreadcrumbs">
<meta name="twitter:title" content="fastaibreadcrumbs - fastai-breadcrumbs.core">
<meta name="twitter:description" content="Functions for fastaibreadcrumbs.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">fastaibreadcrumbs</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">fastai-breadcrumbs.core</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Fastaibreadcrumbs</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./core.html" class="sidebar-item-text sidebar-link active">fastai-breadcrumbs.core</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setting-kaggle-data-on-local-machine" id="toc-setting-kaggle-data-on-local-machine" class="nav-link active" data-scroll-target="#setting-kaggle-data-on-local-machine">Setting kaggle data on local machine</a>
  <ul class="collapse">
  <li><a href="#setup_data" id="toc-setup_data" class="nav-link" data-scroll-target="#setup_data">setup_data</a></li>
  </ul></li>
  <li><a href="#crappify-your-data" id="toc-crappify-your-data" class="nav-link" data-scroll-target="#crappify-your-data">Crappify your data</a>
  <ul class="collapse">
  <li><a href="#apply_motion_blur" id="toc-apply_motion_blur" class="nav-link" data-scroll-target="#apply_motion_blur">apply_motion_blur</a></li>
  <li><a href="#crappifier" id="toc-crappifier" class="nav-link" data-scroll-target="#crappifier">Crappifier</a></li>
  <li><a href="#crappifier.__call__" id="toc-crappifier.__call__" class="nav-link" data-scroll-target="#crappifier.__call__">Crappifier.__call__</a></li>
  <li><a href="#show_plot" id="toc-show_plot" class="nav-link" data-scroll-target="#show_plot">show_plot</a></li>
  </ul></li>
  <li><a href="#parallely-crappify-images" id="toc-parallely-crappify-images" class="nav-link" data-scroll-target="#parallely-crappify-images">Parallely crappify images</a>
  <ul class="collapse">
  <li><a href="#crappify_imgs" id="toc-crappify_imgs" class="nav-link" data-scroll-target="#crappify_imgs">crappify_imgs</a></li>
  </ul></li>
  <li><a href="#compare-three-images-side-by-side" id="toc-compare-three-images-side-by-side" class="nav-link" data-scroll-target="#compare-three-images-side-by-side">Compare three images side by side</a>
  <ul class="collapse">
  <li><a href="#compare_imgs" id="toc-compare_imgs" class="nav-link" data-scroll-target="#compare_imgs">compare_imgs</a></li>
  </ul></li>
  <li><a href="#quickly-create-dataloader-for-unet" id="toc-quickly-create-dataloader-for-unet" class="nav-link" data-scroll-target="#quickly-create-dataloader-for-unet">Quickly create dataloader for Unet</a>
  <ul class="collapse">
  <li><a href="#get_unet_dls" id="toc-get_unet_dls" class="nav-link" data-scroll-target="#get_unet_dls">get_unet_dls</a></li>
  </ul></li>
  <li><a href="#calculate-feature-loss" id="toc-calculate-feature-loss" class="nav-link" data-scroll-target="#calculate-feature-loss">Calculate feature loss</a>
  <ul class="collapse">
  <li><a href="#gram_matrix" id="toc-gram_matrix" class="nav-link" data-scroll-target="#gram_matrix">gram_matrix</a></li>
  <li><a href="#featureloss" id="toc-featureloss" class="nav-link" data-scroll-target="#featureloss">FeatureLoss</a></li>
  <li><a href="#calc_ft_loss" id="toc-calc_ft_loss" class="nav-link" data-scroll-target="#calc_ft_loss">calc_ft_loss</a></li>
  </ul></li>
  <li><a href="#saving-generated-images" id="toc-saving-generated-images" class="nav-link" data-scroll-target="#saving-generated-images">Saving generated images</a>
  <ul class="collapse">
  <li><a href="#save_preds" id="toc-save_preds" class="nav-link" data-scroll-target="#save_preds">save_preds</a></li>
  </ul></li>
  <li><a href="#pushing-notebook-to-kaggle" id="toc-pushing-notebook-to-kaggle" class="nav-link" data-scroll-target="#pushing-notebook-to-kaggle">Pushing notebook to kaggle</a>
  <ul class="collapse">
  <li><a href="#non_competition_nb_meta" id="toc-non_competition_nb_meta" class="nav-link" data-scroll-target="#non_competition_nb_meta">non_competition_nb_meta</a></li>
  <li><a href="#push_non_competition_notebook" id="toc-push_non_competition_notebook" class="nav-link" data-scroll-target="#push_non_competition_notebook">push_non_competition_notebook</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/sapal6/fastaibreadcrumbs/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">fastai-breadcrumbs.core</h1>
</div>

<div>
  <div class="description">
    Functions for fastaibreadcrumbs.
  </div>
</div>


<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="setting-kaggle-data-on-local-machine" class="level2">
<h2 class="anchored" data-anchor-id="setting-kaggle-data-on-local-machine">Setting kaggle data on local machine</h2>
<hr>
<p><a href="https://github.com/sapal6/fastaibreadcrumbs/blob/main/fastaibreadcrumbs/core.py#L14" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="setup_data" class="level3">
<h3 class="anchored" data-anchor-id="setup_data">setup_data</h3>
<blockquote class="blockquote">
<pre><code> setup_data (user:str, dataset:str, install='')</code></pre>
</blockquote>
<p>Get a path to data for the <code>user's</code> <code>dataset</code>, downloading it if needed</p>
<p>This function is similar to the <code>setup_comp</code> function in <a href="https://fastai.github.io/fastkaggle/">“fastkaggle”</a> which will download the dataset from kaggle and unzip it to your local machine if it’s not there already. <a href="https://sapal6.github.io/fastaibreadcrumbs/core.html#setup_data"><code>setup_data</code></a> accepts the user name (which is the userid tagged to that dataset which you want to download) and the dataset name. You may also pass a library name to the <code>install</code> argument separated by space. Doing so will install the required libraries on your machine (by default it’s blank which means that no library needs to be installed).</p>
<p>Be sure to have setup a kaggle API for your username and have the kaggle.json downloaded to youtr local machine before using this function.</p>
<p>For example when you do the following–&gt;</p>
<pre><code>setup_data('sapal6', 'superresolution')</code></pre>
<p>The output would be</p>
<pre><code>Path('superresolution/busystreet')</code></pre>
</section>
</section>
<section id="crappify-your-data" class="level2">
<h2 class="anchored" data-anchor-id="crappify-your-data">Crappify your data</h2>
<p>Sometimes we need to simulate motion blur. We can do this by using numpy to create a small window of a specific size which can be moved place above an image and then move it around the image and distort the pixels in a particular direction which in effect will simulate a camera shake in a particular direction. At the very basic level this “moving a window around and image and applyiung motion blur” is matrix multiplication for which we can use opencv’s <a href="https://docs.opencv.org/3.4/d4/d61/tutorial_warp_affine.html">affine transformations</a> followed by <a href="https://docs.opencv.org/3.4/da/d54/group__imgproc__transform.html#gafbbc470ce83812914a70abfb604f4326">getRotationMatrix2D</a>.</p>
<hr>
<p><a href="https://github.com/sapal6/fastaibreadcrumbs/blob/main/fastaibreadcrumbs/core.py#L28" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="apply_motion_blur" class="level3">
<h3 class="anchored" data-anchor-id="apply_motion_blur">apply_motion_blur</h3>
<blockquote class="blockquote">
<pre><code> apply_motion_blur (img, sz:int, angle:int)</code></pre>
</blockquote>
<p>apply motion blur in images at the givn angle and size of blur lines</p>
<p><a href="https://sapal6.github.io/fastaibreadcrumbs/core.html#apply_motion_blur"><code>apply_motion_blur</code></a> is a lower level function which accepts an image (via <code>img</code>) and creates blur effect in that image as per the size of the blur (<code>sz</code>) which determines the strength of the blur and the <code>angle</code> in which the blur is to be applied.</p>
<p>The <code>crappifier</code> is the high level function that you would use to simulate motion blur for a single image.</p>
<hr>
<p><a href="https://github.com/sapal6/fastaibreadcrumbs/blob/main/fastaibreadcrumbs/core.py#L38" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="crappifier" class="level3">
<h3 class="anchored" data-anchor-id="crappifier">Crappifier</h3>
<blockquote class="blockquote">
<pre><code> Crappifier (dest, sz:int=30, angle:int=0)</code></pre>
</blockquote>
<p>apply motion blur on images</p>
<hr>
<p><a href="https://github.com/sapal6/fastaibreadcrumbs/blob/main/fastaibreadcrumbs/core.py#L44" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="crappifier.__call__" class="level3">
<h3 class="anchored" data-anchor-id="crappifier.__call__">Crappifier.__call__</h3>
<blockquote class="blockquote">
<pre><code> Crappifier.__call__ (file)</code></pre>
</blockquote>
<p>call the Crappifier on an image file</p>
<p>Given a file source (<code>file</code>) and the destination (<code>dest</code>) <code>crappifier</code> can create motion blur in the source image as per the size (<code>sz</code>) and the <code>angle</code> in which the blur needs to be applied.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>hr_path <span class="op">=</span> Path(<span class="st">'test/imgs'</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>crappy_path <span class="op">=</span> Path(<span class="st">'test/crappy'</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>files_hr <span class="op">=</span> get_image_files(hr_path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>files_hr[<span class="dv">0</span>].parents[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Path('test/imgs')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>crappy_path<span class="op">/</span>files_hr[<span class="dv">0</span>].relative_to(files_hr[<span class="dv">0</span>].parents[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Path('test/crappy/test/test_img.jpg')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Crappifier(crappy_path)(files_hr[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/sapal6/fastaibreadcrumbs/blob/main/fastaibreadcrumbs/core.py#L56" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="show_plot" class="level3">
<h3 class="anchored" data-anchor-id="show_plot">show_plot</h3>
<blockquote class="blockquote">
<pre><code> show_plot (fn_first:pathlib.Path, fn_second:pathlib.Path, nrow:int,
            szs:tuple)</code></pre>
</blockquote>
<p>show two images side by side for given number of rows and figure size</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>files_crappy <span class="op">=</span> get_image_files(crappy_path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>show_plot(files_hr[<span class="dv">0</span>], files_crappy[<span class="dv">0</span>], <span class="dv">1</span>, (<span class="dv">10</span>, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="00_core_files/figure-html/cell-13-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="parallely-crappify-images" class="level2">
<h2 class="anchored" data-anchor-id="parallely-crappify-images">Parallely crappify images</h2>
<p>When you need to crappify multiple images then save time by parallely crappifying images with <a href="https://sapal6.github.io/fastaibreadcrumbs/core.html#crappify_imgs"><code>crappify_imgs</code></a>.</p>
<hr>
<p><a href="https://github.com/sapal6/fastaibreadcrumbs/blob/main/fastaibreadcrumbs/core.py#L68" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="crappify_imgs" class="level3">
<h3 class="anchored" data-anchor-id="crappify_imgs">crappify_imgs</h3>
<blockquote class="blockquote">
<pre><code> crappify_imgs (path_hr:pathlib.Path, path_crappy:pathlib.Path, sz=30,
                angle:int=0, n_workers=2)</code></pre>
</blockquote>
<p>parallely crappify images</p>
<p>Provide the <code>path_hr</code> for the source image and the <code>path_crappy</code> for destination, alongwith the <code>sz</code> for the strength of the blur and the angle of the blurs. <code>n_workers</code> will determine the number of cpus would be used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>crappify_imgs(hr_path, crappy_path, n_workers<span class="op">=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="compare-three-images-side-by-side" class="level2">
<h2 class="anchored" data-anchor-id="compare-three-images-side-by-side">Compare three images side by side</h2>
<p>When you want to compare three images side by side then use <a href="https://sapal6.github.io/fastaibreadcrumbs/core.html#compare_imgs"><code>compare_imgs</code></a>. For example, you have a set of original images, crappified images, generated images and you want to compare them side by side.</p>
<hr>
<p><a href="https://github.com/sapal6/fastaibreadcrumbs/blob/main/fastaibreadcrumbs/core.py#L75" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="compare_imgs" class="level3">
<h3 class="anchored" data-anchor-id="compare_imgs">compare_imgs</h3>
<blockquote class="blockquote">
<pre><code> compare_imgs (origs:fastcore.foundation.L, crappys:fastcore.foundation.L,
               preds:fastcore.foundation.L, szs:tuple, nrow:int=9,
               fontsz=100)</code></pre>
</blockquote>
<p>compare 3 images side by side for given number of rows and figure size</p>
<p>Provide the <code>origs</code> list for the collection of the original images, <code>crappys</code> for the list of crappified images and the <code>preds</code> for the list of generated images. The plot sizes can be controlled with the <code>szs</code> tuple. The number of plots to be displayed can be controlled via <code>nrow</code> and the title size can be controlled by <code>fontsz</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>files_gen <span class="op">=</span> get_image_files(Path(<span class="st">'test/generated'</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>files_gen</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(#1) [Path('test/generated/test/test_img.jpg')]</code></pre>
</div>
</div>
<p>For example –&gt;</p>
<p><code>compare_imgs(files_hr, files_crappy, files_gen, (64, 64))</code></p>
</section>
</section>
<section id="quickly-create-dataloader-for-unet" class="level2">
<h2 class="anchored" data-anchor-id="quickly-create-dataloader-for-unet">Quickly create dataloader for Unet</h2>
<hr>
<p><a href="https://github.com/sapal6/fastaibreadcrumbs/blob/main/fastaibreadcrumbs/core.py#L108" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="get_unet_dls" class="level3">
<h3 class="anchored" data-anchor-id="get_unet_dls">get_unet_dls</h3>
<blockquote class="blockquote">
<pre><code> get_unet_dls (bs:int, source=None, blocks:tuple=(&lt;function ImageBlock at
               0x7fdfef76ba30&gt;, &lt;function ImageBlock at 0x7fdfef76ba30&gt;),
               dl_type=None, getters=None, n_inp=None, get_items=None,
               get_y=None, get_x=None, splitter=None, item_tfms=None,
               batch_tfms=None, **kwargs)</code></pre>
</blockquote>
<p>function to create the datablock and the dataloader for Unet</p>
<p>This is a convenience function to setup a datablock and dataloader for a unet when the x and y blocks both are images. All the regular arguments which you pass to a regular fastai dataloader and dataset can be passed here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>item_tfms<span class="op">=</span>Resize(<span class="dv">128</span>, method<span class="op">=</span><span class="st">'squish'</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>batch_tfms<span class="op">=</span>[<span class="op">*</span>aug_transforms(size<span class="op">=</span><span class="dv">64</span>, min_scale<span class="op">=</span><span class="fl">0.75</span>), Normalize.from_stats(<span class="op">*</span>imagenet_stats)]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>dls<span class="op">=</span>get_unet_dls(<span class="dv">1</span>, get_image_files(<span class="st">'test'</span>), get_y<span class="op">=</span><span class="kw">lambda</span> x: Path(<span class="st">'test'</span>)<span class="op">/</span>x.relative_to(Path(<span class="st">'test'</span>)),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                  splitter<span class="op">=</span>RandomSplitter(), item_tfms<span class="op">=</span>item_tfms, batch_tfms<span class="op">=</span>batch_tfms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>dls.show_batch()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="00_core_files/figure-html/cell-20-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="calculate-feature-loss" class="level2">
<h2 class="anchored" data-anchor-id="calculate-feature-loss">Calculate feature loss</h2>
<hr>
<p><a href="https://github.com/sapal6/fastaibreadcrumbs/blob/main/fastaibreadcrumbs/core.py#L130" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="gram_matrix" class="level3">
<h3 class="anchored" data-anchor-id="gram_matrix">gram_matrix</h3>
<blockquote class="blockquote">
<pre><code> gram_matrix (x)</code></pre>
</blockquote>
<p>function to calculate the gram matrix</p>
<hr>
<p><a href="https://github.com/sapal6/fastaibreadcrumbs/blob/main/fastaibreadcrumbs/core.py#L140" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="featureloss" class="level3">
<h3 class="anchored" data-anchor-id="featureloss">FeatureLoss</h3>
<blockquote class="blockquote">
<pre><code> FeatureLoss (m_feat, layer_ids, layer_wgts)</code></pre>
</blockquote>
<p>Class to calculate feature loss</p>
<p>Feature loss helps the network to compare the pixels of the target and the input image and check if the two images are the same.</p>
<p>We only need to pass the images through the netowrk once. So, we need to turn off the updates to the network weights. <code>requires_grad_</code> is like asking the network “do not train”. We need to extract the features from our input image as well as the target image which we can compare later. To extract the features, we will use a simple pre-trained network like “vgg16”.</p>
<hr>
<p><a href="https://github.com/sapal6/fastaibreadcrumbs/blob/main/fastaibreadcrumbs/core.py#L170" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="calc_ft_loss" class="level3">
<h3 class="anchored" data-anchor-id="calc_ft_loss">calc_ft_loss</h3>
<blockquote class="blockquote">
<pre><code> calc_ft_loss (pretrained=True)</code></pre>
</blockquote>
<p>calculate the feature loss using the given architecture</p>
<p>The features are grabbed just before the grid size changes and the maxpooling layer in network is where the grid size change occurs. We iterate over the different layers of the network (children) and then grabbing the layer just before the maxpool layer (i-1) as this is where the grid size changes</p>
</section>
</section>
<section id="saving-generated-images" class="level2">
<h2 class="anchored" data-anchor-id="saving-generated-images">Saving generated images</h2>
<p><a href="https://sapal6.github.io/fastaibreadcrumbs/core.html#save_preds"><code>save_preds</code></a> iterates through the predicitons one by one and then converts the predictions into images. After that it saves the image into the destination path.</p>
<hr>
<p><a href="https://github.com/sapal6/fastaibreadcrumbs/blob/main/fastaibreadcrumbs/core.py#L178" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="save_preds" class="level3">
<h3 class="anchored" data-anchor-id="save_preds">save_preds</h3>
<blockquote class="blockquote">
<pre><code> save_preds (dl, learn, dest)</code></pre>
</blockquote>
<p>Save away predictions</p>
<p>you will need to pass the dataloader, learner and the destination respectively.</p>
</section>
</section>
<section id="pushing-notebook-to-kaggle" class="level2">
<h2 class="anchored" data-anchor-id="pushing-notebook-to-kaggle">Pushing notebook to kaggle</h2>
<p>“fastkaggle” povides a way to push notebooks to kaggle from your local machine but this function deals with notebooks meant for competitions only and as such it takes care of data sources meant for a competition. For ceratin use case we need the ability to attach non-competition data sources to our kaggle notebook.</p>
<hr>
<p><a href="https://github.com/sapal6/fastaibreadcrumbs/blob/main/fastaibreadcrumbs/core.py#L191" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="non_competition_nb_meta" class="level3">
<h3 class="anchored" data-anchor-id="non_competition_nb_meta">non_competition_nb_meta</h3>
<blockquote class="blockquote">
<pre><code> non_competition_nb_meta (user, id, title, file, dataset=None,
                          private=True, gpu=False, internet=True)</code></pre>
</blockquote>
<p>Get the <code>dict</code> required for a kernel-metadata.json file</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>non_competition_nb_meta(<span class="st">'sapal6'</span>, <span class="st">'my-notebook'</span>, <span class="st">'My notebook'</span>, <span class="st">'my-notebook.ipynb'</span>, dataset<span class="op">=</span><span class="st">'some_data'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>{'id': 'sapal6/my-notebook',
 'title': 'My notebook',
 'code_file': 'my-notebook.ipynb',
 'language': 'python',
 'kernel_type': 'notebook',
 'is_private': True,
 'enable_gpu': False,
 'enable_internet': True,
 'keywords': [],
 'dataset_sources': ['sapal6/some_data'],
 'kernel_sources': []}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/sapal6/fastaibreadcrumbs/blob/main/fastaibreadcrumbs/core.py#L210" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="push_non_competition_notebook" class="level3">
<h3 class="anchored" data-anchor-id="push_non_competition_notebook">push_non_competition_notebook</h3>
<blockquote class="blockquote">
<pre><code> push_non_competition_notebook (user, id, title, file, path='.',
                                dataset=None, private=True, gpu=False,
                                internet=True)</code></pre>
</blockquote>
<p>Push notebook <code>file</code> to Kaggle Notebooks</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>